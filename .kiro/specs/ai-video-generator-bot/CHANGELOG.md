# Changelog - Обновление до тестовой версии (10 сегментов)

## Дата: 2025-11-13

### Основные изменения

#### 1. Сокращение длительности видео для отладки
- **Было:** 48 сегментов × 5 сек = 240 сек (4 минуты)
- **Стало:** 10 сегментов × 5 сек = 50 сек

#### 2. Новая структура сегментов
- **Intro (0-2):** 3 сегмента = 15 секунд - вступление
- **Main (3-6):** 4 сегмента = 20 секунд - основная часть  
- **Outro (7-9):** 3 сегмента = 15 секунд - заключение

#### 3. Специализированные OpenAI Assistants
Вместо одного универсального Assistant'а теперь используются три специализированных:

- **Script Assistant** (`OPENAI_SCRIPT_ASSISTANT_ID`)
  - Генерирует сценарий для 50-секундного видео
  - Создает структуру: intro (15 сек) + main (20 сек) + outro (15 сек)

- **Segment Assistant** (`OPENAI_SEGMENT_ASSISTANT_ID`)
  - Разбивает сценарий на 10 сегментов по 5 секунд
  - Генерирует промпты для изображений каждого сегмента
  - Определяет тип сегмента (intro/main/outro)

- **Animation Assistant** (`OPENAI_ANIMATION_ASSISTANT_ID`)
  - Создает промпты для анимации каждого изображения
  - Учитывает контекст и тип сегмента

#### 4. Обновленные параметры прогресса
- **Было:** Обновления каждые 10 сегментов
- **Стало:** Обновления каждые 5 сегментов

#### 5. Обновленные превью для утверждения
- **Изображения:** Первые 3 (было 5)
- **Видео:** Первые 2 (было 3)

### Обновленные файлы

#### requirements.md
- ✅ Обновлено введение (50 секунд вместо 4 минут)
- ✅ Добавлены новые термины в глоссарий (Script/Segment/Animation Assistant)
- ✅ Обновлены критерии приемки для всех требований
- ✅ Изменены ссылки на специализированных Assistant'ов

#### design.md
- ✅ Обновлен обзор системы
- ✅ Добавлена конфигурация для 10 сегментов
- ✅ Обновлены методы OpenAIService для работы с 3 Assistant'ами
- ✅ Изменена логика разбивки сценария
- ✅ Обновлены параметры прогресса и превью

#### tasks.md
- ✅ Обновлены описания завершенных задач (1-22)
- ✅ Добавлена новая задача #23: Создание инструкций для Assistant'ов
- ✅ Перенумерованы оставшиеся задачи (24-31)
- ✅ Обновлены ссылки на конфигурацию и параметры

### Конфигурация (.env)

Новые переменные окружения:
```bash
# Specialized Assistant IDs
OPENAI_SCRIPT_ASSISTANT_ID=asst_xxx
OPENAI_SEGMENT_ASSISTANT_ID=asst_xxx
OPENAI_ANIMATION_ASSISTANT_ID=asst_xxx

# Video Configuration
NUM_SEGMENTS=10
TARGET_VIDEO_DURATION=50
INTRO_SEGMENTS=0,1,2
MAIN_SEGMENTS=3,4,5,6
OUTRO_SEGMENTS=7,8,9
```

### Следующие шаги

1. **Задача #23:** Создать инструкции для трех Assistant'ов
2. **Задача #24:** Загрузить FFmpeg бинарники
3. **Задача #25-27:** Доработать интеграцию сервисов
4. **Задача #28-31:** Тестирование и deployment

### Преимущества тестовой версии

✅ **Быстрая отладка** - 50 секунд вместо 4 минут  
✅ **Меньше затрат** - в 4.8 раза меньше API вызовов к Runway  
✅ **Специализация** - каждый Assistant делает свою задачу лучше  
✅ **Легкое масштабирование** - после отладки можно увеличить до 48 сегментов

### Обратная совместимость

Сохранена переменная `OPENAI_ASSISTANT_ID` для обратной совместимости (fallback).
